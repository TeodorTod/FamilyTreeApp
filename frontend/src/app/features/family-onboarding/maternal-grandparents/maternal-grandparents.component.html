<h1 class="d-flex justify-center align-center">
  {{ CONSTANTS.INFO_MATERNAL_GRANDPARENTS | translate }}
</h1>

<div
  class="d-flex justify-center w-full gap-5 mathernal-grandparents-container"
>
  <div class="granparents">
    <!-- GRANDMOTHER -->
    <form
      [formGroup]="grandmotherForm"
      class="initial-forms d-flex justify-center flex-column align-items-center gap-2 w-full"
    >
      <h2 class="d-flex justify-center">
        {{ CONSTANTS.INFO_MATERNAL_GRANDMOTHER | translate }}
      </h2>

      <div class="floating-field">
        <input pInputText formControlName="firstName" placeholder=" " />
        <label>{{ CONSTANTS.INFO_FIRST_NAME | translate }}</label>
      </div>

      <div class="floating-field">
        <input pInputText formControlName="middleName" placeholder=" " />
        <label>{{ CONSTANTS.INFO_MIDDLE_NAME | translate }}</label>
      </div>

      <div class="floating-field">
        <input pInputText formControlName="lastName" placeholder=" " />
        <label>{{ CONSTANTS.INFO_LAST_NAME | translate }}</label>
      </div>

      <!-- DOB Mode -->
      <span class="p-float-label w-full mb-3">
        <label for="gmDobMode">{{ CONSTANTS.INFO_DOB_MODE | translate }}</label>
        <p-select
          inputId="dobMode"
          formControlName="dobMode"
          [options]="dobModeOptions"
          optionLabel="label"
          optionValue="value"
          class="w-full"
        >
        </p-select>
      </span>

      <!-- DOB: exact -->
      @if (grandmotherForm.value.dobMode === 'exact') {
      <div
        class="floating-field"
        [class.active]="grandmotherForm.get('dob')?.value"
      >
        <label>{{ CONSTANTS.INFO_DATE_OF_BIRTH | translate }}</label>
        <p-datepicker
          formControlName="dob"
          dateFormat="yy-mm-dd"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
        ></p-datepicker>
      </div>
      }

      <!-- DOB: year -->
      @if (grandmotherForm.value.dobMode === 'year') {
      <div
        class="floating-field"
        [class.active]="grandmotherForm.get('dob')?.value"
      >
        <label>{{ CONSTANTS.INFO_DOB_YEAR_ONLY | translate }}</label>
        <p-datepicker
          formControlName="dob"
          [view]="'year'"
          [dateFormat]="'yy'"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
        ></p-datepicker>
      </div>
      }

      <!-- DOB: note -->
      @if (grandmotherForm.value.dobMode === 'note') {
      <div class="floating-field">
        <input pInputText formControlName="birthNote" placeholder=" " />
        <label>{{ CONSTANTS.INFO_DOB_NOTE_LABEL | translate }}</label>
      </div>
      }

      <!-- Alive? -->
      <div class="d-flex align-items-center gap-2 mb-3">
        <p-checkbox
          binary="true"
          formControlName="isAlive"
          inputId="grandmotherAlive"
        ></p-checkbox>
        <label for="grandmotherAlive" class="mb-0">{{
          CONSTANTS.INFO_IS_ALIVE | translate
        }}</label>
      </div>

      <!-- DOD tri-mode (only if not alive) -->
      @if (!grandmotherForm.value.isAlive) {

      <span class="p-float-label w-full mb-3">
        <label for="gmDodMode">{{ CONSTANTS.INFO_DOD_MODE | translate }}</label>
        <p-select
          inputId="dodMode"
          formControlName="dodMode"
          [options]="dodModeOptions"
          optionLabel="label"
          optionValue="value"
          class="w-full"
        >
        </p-select>
      </span>

      <!-- DOD: exact -->
      @if (grandmotherForm.value.dodMode === 'exact') {
      <div
        class="floating-field"
        [class.active]="grandmotherForm.get('dod')?.value"
      >
        <p-datepicker
          formControlName="dod"
          dateFormat="yy-mm-dd"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
          appendTo="body"
        ></p-datepicker>
      </div>
      }

      <!-- DOD: year -->
      @if (grandmotherForm.value.dodMode === 'year') {
      <div
        class="floating-field"
        [class.active]="grandmotherForm.get('deathYearDate')?.value"
      >
        <label>{{ CONSTANTS.INFO_DOB_YEAR_ONLY | translate }}</label>
        <p-datepicker
          formControlName="deathYearDate"
          [view]="'year'"
          [dateFormat]="'yy'"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
          appendTo="body"
        ></p-datepicker>
      </div>
      }

      <!-- DOD: note -->
      @if (grandmotherForm.value.dodMode === 'note') {
      <div class="floating-field">
        <input pInputText formControlName="deathNote" placeholder=" " />
        <label>{{ CONSTANTS.INFO_DOB_NOTE_LABEL | translate }}</label>
      </div>
      } }

      <!-- Photo -->
      <div
        class="floating-field file-label"
        [class.active]="grandmotherPhotoUrl()"
      >
        <label>{{ CONSTANTS.INFO_PHOTO_LABEL | translate }}</label>

        @if (grandmotherPhotoUrl()) {
        <div class="photo-preview-container">
          <img
            [src]="apiUrl + grandmotherPhotoUrl()"
            alt="Uploaded"
            class="uploaded-photo-preview"
          />
          <button
            type="button"
            class="photo-remove-button"
            (click)="clearPhoto(Roles.MATERNAL_GRANDMOTHER)"
            aria-label="Remove photo"
          >
            ✖
          </button>
        </div>
        } @else {
        <p-fileUpload
          name="photo"
          customUpload
          [auto]="true"
          [showUploadButton]="false"
          [showCancelButton]="false"
          (uploadHandler)="uploadPhoto($event, Roles.MATERNAL_GRANDMOTHER)"
          chooseLabel="{{ CONSTANTS.ADD_PHOTO | translate }}"
          class="w-full"
        />
        }
      </div>
    </form>
  </div>

  <!-- GRANDFATHER -->
  <div class="granparents">
    <form
      [formGroup]="grandfatherForm"
      class="initial-forms d-flex justify-center flex-column align-items-center gap-2 w-full"
    >
      <h2 class="d-flex justify-center">
        {{ CONSTANTS.INFO_MATERNAL_GRANDFATHER | translate }}
      </h2>

      <div class="floating-field">
        <input pInputText formControlName="firstName" placeholder=" " />
        <label>{{ CONSTANTS.INFO_FIRST_NAME | translate }}</label>
      </div>

      <div class="floating-field">
        <input pInputText formControlName="middleName" placeholder=" " />
        <label>{{ CONSTANTS.INFO_MIDDLE_NAME | translate }}</label>
      </div>

      <div class="floating-field">
        <input pInputText formControlName="lastName" placeholder=" " />
        <label>{{ CONSTANTS.INFO_LAST_NAME | translate }}</label>
      </div>

      <!-- DOB Mode -->
      <span class="p-float-label w-full mb-3">
        <label for="gfDobMode">{{ CONSTANTS.INFO_DOB_MODE | translate }}</label>
        <p-select
          inputId="dobMode"
          formControlName="dobMode"
          [options]="dobModeOptions"
          optionLabel="label"
          optionValue="value"
          class="w-full"
        >
        </p-select>
      </span>

      <!-- DOB: exact -->
      @if (grandfatherForm.value.dobMode === 'exact') {
      <div
        class="floating-field"
        [class.active]="grandfatherForm.get('dob')?.value"
      >
        <label>{{ CONSTANTS.INFO_DATE_OF_BIRTH | translate }}</label>
        <p-datepicker
          formControlName="dob"
          dateFormat="yy-mm-dd"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
        ></p-datepicker>
      </div>
      }

      <!-- DOB: year -->
      @if (grandfatherForm.value.dobMode === 'year') {
      <div
        class="floating-field"
        [class.active]="grandfatherForm.get('dob')?.value"
      >
        <label>{{ CONSTANTS.INFO_DOB_YEAR_ONLY | translate }}</label>
        <p-datepicker
          formControlName="dob"
          [view]="'year'"
          [dateFormat]="'yy'"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
        ></p-datepicker>
      </div>
      }

      <!-- DOB: note -->
      @if (grandfatherForm.value.dobMode === 'note') {
      <div class="floating-field">
        <input pInputText formControlName="birthNote" placeholder=" " />
        <label>{{ CONSTANTS.INFO_DOB_NOTE_LABEL | translate }}</label>
      </div>
      }

      <!-- Alive? -->
      <div class="d-flex align-items-center gap-2 mb-3">
        <p-checkbox
          binary="true"
          formControlName="isAlive"
          inputId="grandfatherAlive"
        ></p-checkbox>
        <label for="grandfatherAlive" class="mb-0">{{
          CONSTANTS.INFO_IS_ALIVE | translate
        }}</label>
      </div>

      <!-- DOD tri-mode (only if not alive) -->
      @if (!grandfatherForm.value.isAlive) {

      <span class="p-float-label w-full mb-3">
        <label for="gfDodMode">{{ CONSTANTS.INFO_DOD_MODE | translate }}</label>
        <p-select
          inputId="dodMode"
          formControlName="dodMode"
          [options]="dodModeOptions"
          optionLabel="label"
          optionValue="value"
          class="w-full"
        >
        </p-select>
      </span>

      <!-- DOD: exact -->
      @if (grandfatherForm.value.dodMode === 'exact') {
      <div
        class="floating-field"
        [class.active]="grandfatherForm.get('dod')?.value"
      >
        <p-datepicker
          formControlName="dod"
          dateFormat="yy-mm-dd"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
          appendTo="body"
        ></p-datepicker>
      </div>
      }

      <!-- DOD: year -->
      @if (grandfatherForm.value.dodMode === 'year') {
      <div
        class="floating-field"
        [class.active]="grandfatherForm.get('deathYearDate')?.value"
      >
        <label>{{ CONSTANTS.INFO_DOD_YEAR_ONLY | translate }}</label>
        <p-datepicker
          formControlName="deathYearDate"
          [view]="'year'"
          [dateFormat]="'yy'"
          [showIcon]="true"
          [iconDisplay]="'input'"
          [style]="{ width: '100%' }"
          appendTo="body"
        ></p-datepicker>
      </div>
      }

      <!-- DOD: note -->
      @if (grandfatherForm.value.dodMode === 'note') {
      <div class="floating-field">
        <input pInputText formControlName="deathNote" placeholder=" " />
        <label>{{ CONSTANTS.INFO_DOD_NOTE_LABEL | translate }}</label>
      </div>
      } }

      <!-- Photo -->
      <div
        class="floating-field file-label"
        [class.active]="grandfatherPhotoUrl()"
      >
        <label>{{ CONSTANTS.INFO_PHOTO_LABEL | translate }}</label>

        @if (grandfatherPhotoUrl()) {
        <div class="photo-preview-container">
          <img
            [src]="apiUrl + grandfatherPhotoUrl()"
            alt="Uploaded"
            class="uploaded-photo-preview"
          />
          <button
            type="button"
            class="photo-remove-button"
            (click)="clearPhoto(Roles.MATERNAL_GRANDFATHER)"
            aria-label="Remove photo"
          >
            ✖
          </button>
        </div>
        } @else {
        <p-fileUpload
          name="photo"
          customUpload
          [auto]="true"
          [showUploadButton]="false"
          [showCancelButton]="false"
          (uploadHandler)="uploadPhoto($event, Roles.MATERNAL_GRANDFATHER)"
          chooseLabel="{{ CONSTANTS.ADD_PHOTO | translate }}"
          class="w-full"
        />
        }
      </div>
    </form>
  </div>
</div>

<!-- Navigation Buttons -->
<div class="d-flex justify-center gap-5 maternal-parents-buttons">
  <button
    pButton
    type="button"
    label="{{ CONSTANTS.INFO_BACK | translate }}"
    icon="pi pi-arrow-left"
    (click)="back()"
    class="p-button-secondary max-w-360 f-width"
  ></button>

  <button
    pButton
    type="button"
    label="{{ CONSTANTS.INFO_FORWARD | translate }}"
    icon="pi pi-arrow-right"
    (click)="save()"
    class="p-button-primary max-w-360 f-width"
    [disabled]="!grandmotherForm.valid || !grandfatherForm.valid"
  ></button>
</div>
